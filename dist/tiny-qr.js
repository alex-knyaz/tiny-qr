var R=(Q,q,$)=>{for(let W=1<<q-1;W;W=W>>>1)Q.push(W&$?1:0)},b=(Q)=>{let q=Q.length,$=[];for(let H=0;H<q;H++)R($,8,Q[H]);let W={},Z=[0,1,0,0];if(R(Z,16,q),W.data10=W.data27=Z.concat($),q<256){let H=[0,1,0,0];R(H,8,q),W.data1=H.concat($)}return W},J=((Q)=>{let q={};for(let $=0;$<Q.length;$++)q[Q[$]]=$;return q})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"),k=(Q)=>{let q=Q.length,$=[];for(let H=0;H<q;H+=2){let K=6,X=J[Q[H]];if(Q[H+1])K=11,X=X*45+J[Q[H+1]];R($,K,X)}let W={},Z=[0,0,1,0];if(R(Z,13,q),W.data27=Z.concat($),q<2048){let H=[0,0,1,0];R(H,11,q),W.data10=H.concat($)}if(q<512){let H=[0,0,1,0];R(H,9,q),W.data1=H.concat($)}return W},g=(Q)=>{let q=Q.length,$=[];for(let H=0;H<q;H+=3){let K=Q.substr(H,3),X=Math.ceil(K.length*10/3);R($,X,parseInt(K,10))}let W={},Z=[0,0,0,1];if(R(Z,14,q),W.data27=Z.concat($),q<4096){let H=[0,0,0,1];R(H,12,q),W.data10=H.concat($)}if(q<1024){let H=[0,0,0,1];R(H,10,q),W.data1=H.concat($)}return W},v=(Q)=>{let q=Q.indexOf("/",8)+1||Q.length,$=P(Q.slice(0,q).toUpperCase(),!1);if(q>=Q.length)return $;let W=P(Q.slice(q),!1);if($.data27=$.data27.concat(W.data27),$.data10&&W.data10)$.data10=$.data10.concat(W.data10);if($.data1&&W.data1)$.data1=$.data1.concat(W.data1);return $},P=(Q,q)=>{let $,W=typeof Q;if(W=="string"||W=="number")$=""+Q,Q=(new TextEncoder()).encode($);else if(Q instanceof Uint8Array)$=Q.toString();else if(Array.isArray(Q))Q=(new TextEncoder()).encode($),$=Q.toString();else throw new Error("Bad data");if(/^[0-9]+$/.test($)){if(Q.length>7089)throw new Error("Too much data");return g($)}if(/^[0-9A-Z \$%\*\+\.\/\:\-]+$/.test($)){if(Q.length>4296)throw new Error("Too much data");return k($)}if(q&&/^https?:/i.test($))return v($);if(Q.length>2953)throw new Error("Too much data");return b(Q)},S=P;var O=[1],E=[];for(let Q=1;Q<256;Q++){let q=O[Q-1]<<1;if(q>255)q=q^285;O[Q]=q,E[q]=Q}var w=(Q)=>O[(Q%255+255)%255],f=(Q)=>{if(Q<1||Q>255)throw Error("Bad log("+Q+")");return E[Q]},T=[[0],[0,0],[0,25,1]],I=(Q)=>{if(T[Q])return T[Q];let q=I(Q-1),$=[];$[0]=q[0];for(let W=1;W<=Q;W++)$[W]=f(w(q[W])^w(q[W-1]+Q-1));return T[Q]=$,$},j=(Q,q)=>{Q=[].slice.call(Q);let $=I(q);for(let W=0;W<q;W++)Q.push(0);while(Q.length>q){if(!Q[0]){Q.shift();continue}let W=f(Q[0]);for(let Z=0;Z<=q;Z++)Q[Z]=Q[Z]^w($[Z]+W);Q.shift()}return new Uint8Array(Q)},L=j;var _=(Q)=>{let q=Q*4+17,$=[],W=new Uint8Array(q);W.fill(0),W=[].slice.call(W);for(let Z=0;Z<q;Z++)$[Z]=W.slice();return $},p=(Q)=>{let q=Q.length;for(let $=-3;$<=3;$++)for(let W=-3;W<=3;W++){let Z=Math.max($,W),H=Math.min($,W),K=Z==2&&H>=-2||H==-2&&Z<=2?128:129;Q[3+$][3+W]=K,Q[3+$][q-4+W]=K,Q[q-4+$][3+W]=K}for(let $=0;$<8;$++)Q[7][$]=Q[$][7]=Q[7][q-$-1]=Q[$][q-8]=Q[q-8][$]=Q[q-1-$][7]=128},c=(Q)=>{let q=Q.length;if(q>21){let $=q-13,W=Math.round($/Math.ceil($/28));if(W%2)W++;let Z=[];for(let H=$+6;H>10;H-=W)Z.unshift(H);Z.unshift(6);for(let H=0;H<Z.length;H++)for(let K=0;K<Z.length;K++){let X=Z[H],G=Z[K];if(Q[X][G])continue;for(let U=-2;U<=2;U++)for(let Y=-2;Y<=2;Y++){let C=Math.max(U,Y),z=Math.min(U,Y),V=C==1&&z>=-1||z==-1&&C<=1?128:129;Q[X+U][G+Y]=V}}}for(let $=8;$<q-8;$++)Q[6][$]=Q[$][6]=$%2?128:129},o=(Q)=>{let q=Q.length;for(let $=0;$<8;$++){if($!=6)Q[8][$]=Q[$][8]=128;Q[8][q-1-$]=128,Q[q-1-$][8]=128}if(Q[8][8]=128,Q[q-8][8]=129,q<45)return;for(let $=q-11;$<q-8;$++)for(let W=0;W<6;W++)Q[$][W]=Q[W][$]=128},h=(()=>{let Q=Array(32),q=Array(40),$=1335,W=7973,Z=21522;for(let K=0;K<32;K++){let X=K<<10;for(let G=5;G>0;G--)if(X>>>9+G)X=X^$<<G-1;Q[K]=(X|K<<10)^Z}for(let K=7;K<=40;K++){let X=K<<12;for(let G=6;G>0;G--)if(X>>>11+G)X=X^W<<G-1;q[K]=X|K<<12}const H={L:1,M:0,Q:3,H:2};return h=(K,X,G)=>{let U=K.length,Y=Q[H[X]<<3|G];function C(D){return Y>>D&1?129:128}for(let D=0;D<8;D++)if(K[8][U-1-D]=C(D),D<6)K[D][8]=C(D);for(let D=8;D<15;D++)if(K[U-15+D][8]=C(D),D>8)K[8][14-D]=C(D);K[7][8]=C(6),K[8][8]=C(7),K[8][7]=C(8);let z=q[(U-17)/4];if(!z)return;function V(D){return z>>D&1?129:128}for(let D=0;D<6;D++)for(let F=0;F<3;F++)K[U-11+F][D]=K[D][U-11+F]=V(D*3+F)}})(),A=(()=>{const Q=[(q,$)=>(q+$)%2==0,(q,$)=>q%2==0,(q,$)=>$%3==0,(q,$)=>(q+$)%3==0,(q,$)=>(Math.floor(q/2)+Math.floor($/3))%2==0,(q,$)=>q*$%2+q*$%3==0,(q,$)=>(q*$%2+q*$%3)%2==0,(q,$)=>(q*$%3+(q+$)%2)%2==0];return A=(q,$,W)=>{let Z=q.length,H,K,X=-1;H=K=Z-1;let G=Q[W],U=$.blocks[$.blocks.length-1].length;for(let z=0;z<U;z++)for(let V=0;V<$.blocks.length;V++){if($.blocks[V].length<=z)continue;Y($.blocks[V][z])}U=$.ec_len;for(let z=0;z<U;z++)for(let V=0;V<$.ec.length;V++)Y($.ec[V][z]);if(K>-1)do q[H][K]=G(H,K)?1:0;while(C());function Y(z){for(let V=128;V;V=V>>1){let D=!!(V&z);if(G(H,K))D=!D;q[H][K]=D?1:0,C()}}function C(){do{if(K%2^K<6)if(X<0&&H==0||X>0&&H==Z-1)K--,X=-X;else K++,H+=X;else K--;if(K==6)K--;if(K<0)return!1}while(q[H][K]&240);return!0}}})(),d=(Q)=>{let q=Q.length,$=0;for(let G=0;G<q;G++){let U=Q[G][0]&1,Y=1;for(let C=1;C<q;C++){let z=Q[G][C]&1;if(z==U){Y++;continue}if(Y>=5)$+=Y-2;U=z,Y=1}if(Y>=5)$+=Y-2}for(let G=0;G<q;G++){let U=Q[0][G]&1,Y=1;for(let C=1;C<q;C++){let z=Q[C][G]&1;if(z==U){Y++;continue}if(Y>=5)$+=Y-2;U=z,Y=1}if(Y>=5)$+=Y-2}for(let G=0;G<q-1;G++)for(let U=0;U<q-1;U++){let Y=Q[G][U]+Q[G][U+1]+Q[G+1][U]+Q[G+1][U+1]&7;if(Y==0||Y==4)$+=3}const W=(G)=>Q[H][K+G]&1,Z=(G)=>Q[H+G][K]&1;for(var H=0;H<q;H++)for(var K=0;K<q;K++){if(K<q-6&&W(0)&&!W(1)&&W(2)&&W(3)&&W(4)&&!W(5)&&W(6)){if(K>=4&&!(W(-4)||W(-3)||W(-2)||W(-1)))$+=40;if(K<q-10&&!(W(7)||W(8)||W(9)||W(10)))$+=40}if(H<q-6&&Z(0)&&!Z(1)&&Z(2)&&Z(3)&&Z(4)&&!Z(5)&&Z(6)){if(H>=4&&!(Z(-4)||Z(-3)||Z(-2)||Z(-1)))$+=40;if(H<q-10&&!(Z(7)||Z(8)||Z(9)||Z(10)))$+=40}}let X=0;for(let G=0;G<q;G++)for(let U=0;U<q;U++)if(Q[G][U]&1)X++;return $+=10*Math.floor(Math.abs(10-20*X/(q*q))),$},x=(Q)=>{let q=_(Q.version);p(q),c(q),o(q);let $=Infinity,W=0;for(let Z=0;Z<8;Z++){A(q,Q,Z),h(q,Q.ec_level,Z);let H=d(q);if(H<$)$=H,W=Z}return A(q,Q,W),h(q,Q.ec_level,W),q.map((Z)=>Z.map((H)=>H&1))},y={getMatrix:x};var B=(Q)=>{let q=Object.assign({},Q);return q.blocks=[...q.blocks],q.ec=[...q.ec],q},N=["L","M","Q","H"],M=[[],[26,7,1,10,1,13,1,17,1],[44,10,1,16,1,22,1,28,1],[70,15,1,26,1,36,2,44,2],[100,20,1,36,2,52,2,64,4],[134,26,1,48,2,72,4,88,4],[172,36,2,64,4,96,4,112,4],[196,40,2,72,4,108,6,130,5],[242,48,2,88,4,132,6,156,6],[292,60,2,110,5,160,8,192,8],[346,72,4,130,5,192,8,224,8],[404,80,4,150,5,224,8,264,11],[466,96,4,176,8,260,10,308,11],[532,104,4,198,9,288,12,352,16],[581,120,4,216,9,320,16,384,16],[655,132,6,240,10,360,12,432,18],[733,144,6,280,10,408,17,480,16],[815,168,6,308,11,448,16,532,19],[901,180,6,338,13,504,18,588,21],[991,196,7,364,14,546,21,650,25],[1085,224,8,416,16,600,20,700,25],[1156,224,8,442,17,644,23,750,25],[1258,252,9,476,17,690,23,816,34],[1364,270,9,504,18,750,25,900,30],[1474,300,10,560,20,810,27,960,32],[1588,312,12,588,21,870,29,1050,35],[1706,336,12,644,23,952,34,1110,37],[1828,360,12,700,25,1020,34,1200,40],[1921,390,13,728,26,1050,35,1260,42],[2051,420,14,784,28,1140,38,1350,45],[2185,450,15,812,29,1200,40,1440,48],[2323,480,16,868,31,1290,43,1530,51],[2465,510,17,924,33,1350,45,1620,54],[2611,540,18,980,35,1440,48,1710,57],[2761,570,19,1036,37,1530,51,1800,60],[2876,570,19,1064,38,1590,53,1890,63],[3034,600,20,1120,40,1680,56,1980,66],[3196,630,21,1204,43,1770,59,2100,70],[3362,660,22,1260,45,1860,62,2220,74],[3532,720,24,1316,47,1950,65,2310,77],[3706,750,25,1372,49,2040,68,2430,81]];M=M.map((Q,q)=>{if(!q)return{};let $={};for(let W=1;W<8;W+=2){let Z=Q[0]-Q[W],H=Q[W+1],K=N[W/2|0],X={version:q,ec_level:K,data_len:Z,ec_len:Q[W]/H,blocks:[],ec:[]};for(let G=H,U=Z;G>0;G--){let Y=U/G|0;X.blocks.push(Y),U-=Y}$[K]=X}return $});var n=(Q,q)=>{let $=1,W;if(Q.data1)W=Math.ceil(Q.data1.length/8);else $=10;for(;$<10;$++){let Z=M[$][q];if(Z.data_len>=W)return B(Z)}if(Q.data10)W=Math.ceil(Q.data10.length/8);else $=27;for(;$<27;$++){let Z=M[$][q];if(Z.data_len>=W)return B(Z)}W=Math.ceil(Q.data27.length/8);for(;$<41;$++){let Z=M[$][q];if(Z.data_len>=W)return B(Z)}throw new Error("Too much data")},l=(Q,q)=>{let $=new Uint8Array(q.data_len);if($.fill(0),q.version<10)Q=Q.data1;else if(q.version<27)Q=Q.data10;else Q=Q.data27;let W=Q.length;for(let K=0;K<W;K+=8){let X=0;for(let G=0;G<8;G++)X=X<<1|(Q[K+G]?1:0);$[K/8]=X}let Z=236;for(let K=Math.ceil((W+4)/8);K<$.length;K++)$[K]=Z,Z=Z==236?17:236;let H=0;return q.blocks=q.blocks.map(function(K){let X=$.slice(H,H+K);return H+=K,q.ec.push(L(X,q.ec_len)),X}),q},u=(Q,q,$)=>{q=N.indexOf(q)>-1?q:"M";let W=S(Q,$),Z=l(W,n(W,q));return y.getMatrix(Z)},e=(Q,q,$)=>{const W=u(Q,q,$);let Z="";return W.forEach((H)=>{H.forEach((K)=>Z+=K?"\u2588\u2588":"\u2000\u2000"),Z+="\n"}),Z},$0=(Q,q,$,W="15px",Z="background-color: black;")=>{const H=u(Q,q,$);let X=`<div style='display: grid; grid-template-columns: repeat(${H[0].length}, ${W});'>`;const G=(U,Y)=>X+=`<span style="${Z} grid-column: ${U} / span ${Y};">&nbsp;</span>`;for(let U=0;U<H.length;U++){let Y=H[U][0],C=1,z=0;for(let V=0;V<H[U].length;V++){if(Y==H[U][V]){z++;continue}if(Y)G(C,z);else C=V+1;z=1,Y=H[U][V]}if(Y)G(C,z)}return X+="</div>",X};export{$0 as get_html_image,e as get_ASCII_image,u as bit_matrix};
